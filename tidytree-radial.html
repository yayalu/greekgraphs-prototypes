<!-- https://observablehq.com/d/3e46e71a8d878ab2 -->
<!DOCTYPE html>
<html lang="en-AU">
    <head>
        <title>Greek graph prototypes</title>
    </head>
    <body>
        <!-- HTML content -->
        <a href="index.html">Back</a>
        <h1 style="text-align: center">Tidytree dendrogram (variable leaf depth)</h1>
        <p style="font-style: italic; text-align: center">Ex: Flare.csv</p>
        <script src="//d3js.org/d3.v3.min.js"></script>
        <script>
            
            var data = d3.json("./data/example.json");
            var width = 932;
            var radius = width / 2;
            const root = tree(d3.hierarchy(data)
                .sort((a, b) => d3.ascending(a.data.name, b.data.name)));
            

            var tree = d3.tree()
            .size([2 * Math.PI, radius])
            .separation((a, b) => (a.parent == b.parent ? 1 : 2) / a.depth);
            
            const svg = d3.create("svg")
                .style("max-width", "100%")
                .style("height", "auto")
                .style("font", "10px sans-serif")
                .style("margin", "5px");

            const link = svg.append("g")
                .attr("fill", "none")
                .attr("stroke", "#ec0080")
                .attr("stroke-opacity", 0.4)
                .attr("stroke-width", 2.5)
                .selectAll("path")
                .data(root.links())
                .join("path")
                .attr("d", d3.linkRadial()
                    .angle(d => d.x)
                    .radius(d => d.y));
            
            const node = svg.append("g")
                .attr("stroke-linejoin", "round")
                .attr("stroke-width", 3)
                .selectAll("g")
                .data(root.descendants().reverse())
                .join("g")
                .attr("transform", d => `
                    rotate(${d.x * 180 / Math.PI - 90})
                    translate(${d.y},0)
                `);
            
            node.append("circle")
                .attr("fill", d => d.children ? "#555" : "#999")
                .attr("r", 5.5);
            
            node.append("text")
                .attr("dy", "0.31em")
                .attr("x", d => d.x < Math.PI === !d.children ? 6 : -6)
                .attr("text-anchor", d => d.x < Math.PI === !d.children ? "start" : "end")
                .attr("transform", d => d.x >= Math.PI ? "rotate(180)" : null)
                .text(d => d.data.name)
                .clone(true).lower()
                .attr("stroke", "white");

            svg.attr("viewBox", autoBox);

            function autoBox() {
            const {x, y, width, height} = this.getBBox();
            return [x, y, width, height];
            }

            </script>
    </body>


</html>